@if (this.currentPage === 0) {
  <mat-card>
    <mat-card-content>
      <div class="row justify-content-between">
        <div class="col-lg-4 negative-margin">
          <mat-form-field appearance="outline">
            <input matInput type="text" placeholder="Tìm kiếm" (keyup)="applyFilter($event)" #input />
            <mat-icon matSuffix>search</mat-icon>
          </mat-form-field>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
  <mat-card class="w-100">
    <mat-card-content>
      <h4 class="fw-bold primary-color">{{"ProductManagement" | translate}}</h4>
  
      <div class="col-12 d-flex align-items-center justify-content-center mb-5 mt-3"></div>
      <div class="table-responsive mt-20">
        <table mat-table [dataSource]="dataSource" matSort class="w-100 text-nowrap">
          <ng-container matColumnDef="image">
            <th mat-header-cell *matHeaderCellDef class="fw-bold primary-color font-size">Hình ảnh</th>
            <td mat-cell *matCellDef="let product">
              <a [href]="product.images[0].url">
                <img
                  class="rounded"
                  width="50px"
                  height="50px"
                  [src]="product.images[0].url"
                  [alt]="product.name"
                />
              </a>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="name" class="fw-bold primary-color font-size">{{"ProductName" | translate}}</th>
            <td mat-cell *matCellDef="let product">
              <p class="mb-0 fw-bold">{{ product.name }}</p>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="price">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="price" class="fw-bold primary-color font-size">{{"ProductPrice" | translate}}</th>
            <td mat-cell *matCellDef="let product">
              <p class="fw-medium mb-0 fw-bold">{{ product.price | number : "1.0" }}₫</p>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="stockBalance">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="stockBalance" class="fw-bold primary-color font-size">{{"ProductQuantity" | translate}}</th>
            <td mat-cell *matCellDef="let product">
              <p class="fw-medium mb-0 fw-bold">{{ product.stockQuantity }}</p>
            </td>
          </ng-container>

          <ng-container matColumnDef="status">
            <th
              class="fw-bold primary-color font-size"
              mat-header-cell
              *matHeaderCellDef
              mat-sort-header="status"
            >
            {{ "Status" | translate }}
            </th>
            <td mat-cell *matCellDef="let product">
              <p
                class="badge fw-bold mb-0"
                [ngClass]="{
                  'badge-success': product.status === 'APPROVED',
                  'badge-warning': product.status === 'PENDING',
                  'badge-rejected': product.status === 'REJECTED'
                }"
              >
                {{ product.status }}
              </p>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef class="fw-bold primary-color font-size">{{"Actions"| translate}}</th>
            <td mat-cell *matCellDef="let product">
              @if (product.status === 'PENDING' ) {
                <button mat-icon-button class="status-approved" (click)="btnApproveFlower(product?.id)">
                  <mat-icon aria-label="check" class="fw-bold">check</mat-icon>
                </button> 
                <button mat-icon-button class="status-rejected">
                  <mat-icon aria-label="do_not_disturb_on" class="fw-bold" (click)="btnChangeStatusPageRejected(1, product)">do_not_disturb_on</mat-icon>
                </button>
              }
              <button type="button" mat-icon-button class="status-pending" (click)="btnChangeStatusPage(1, product)">
                <mat-icon aria-label="visibility" class="fw-bold">visibility</mat-icon>
              </button>
            </td>
          </ng-container>
  
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
        <div *ngIf="totalPages > 1" class="section pagenav clearfix a-center mt-5">
          <nav class="collection-paginate clearfix nav_pagi w_100 relative">
            <ul class="pagination clearfix">
              <li class="page-item" *ngIf="currentPage > 0">
                <a class="page-link" href="javascript:;" (click)="onPageChange(currentPage - 1)">
                  <mat-icon>chevron_left</mat-icon>
                </a>
              </li>
              <li class="page-item" *ngFor="let page of visiblePages; trackBy: trackByIndex" [ngClass]="{ active: page === currentPage + 1 }">
                <a class="page-link" href="javascript:;" (click)="onPageChange(page - 1)">{{ page }}</a>
              </li>
              <li class="page-item" *ngIf="currentPage < totalPages - 1">
                <a class="page-link" href="javascript:;" (click)="onPageChange(currentPage + 1)">
                  <mat-icon>chevron_right</mat-icon>
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
  

}@else if (this.currentPage === 1) {
<div class="container">
  <div class="row">
    <!-- Thông tin bài đăng -->
    <div class="col-md-6">
      <div class="card shadow-sm p-4" style="border-radius: 15px;">
        <div class="card-body">
          <div class="d-flex align-items-center mb-4">
            <a class="page-link primary-color me-2" href="javascript:;" (click)="btnBack()">
              <mat-icon>arrow_back</mat-icon>
            </a>
            <h3 class="primary-color m-0">Thông tin bài đăng</h3>
          </div>          
          <!-- Avatar và tên sản phẩm -->
          <div class="text-center mb-4 ">
            <div *ngIf="flower?.images?.length">
              <img
                *ngFor="let image of flower?.images | slice:0:2"
                class="rounded flower-image "
                [src]="image.url"
                [alt]="flower?.name"
              />
            </div>
            <h4 class="font-weight-bold text-dark mt-2">{{flower?.name}}</h4>
            <div class="d-flex justify-content-center align-items-center text-muted">
              <mat-icon
              [ngClass]="{
                'status-pending': flower?.status === 'PENDING',
                'status-approved': flower?.status === 'APPROVED',
                'status-rejected': flower?.status === 'REJECTED',
                'status-expired': flower?.status === 'EXPIRED'
              }"  
              aria-hidden="false" 
              fontIcon="check_circle"></mat-icon>
              <span class="ml-2 fw-bold"
              >Trạng thái: <strong
              [ngClass]="{
                'status-pending': flower?.status === 'PENDING',
                'status-approved': flower?.status === 'APPROVED',
                'status-rejected': flower?.status === 'REJECTED',
                'status-expired': flower?.status === 'EXPIRED'
              }" 
              class="green-text fw-bold ">{{flower?.status}}</strong></span>
            </div>
          </div>

          <!-- Thông tin chi tiết sản phẩm bằng bảng -->
          <table class="table table-bordered">
            <tr>
              <td><strong class="text-secondary">Giá sản phẩm (VNĐ)</strong></td>
              <td class="fw-bold text-dark">{{flower?.price | number}} VNĐ</td>
            </tr>
            <tr>
              <td><strong class="text-secondary">Số lượng sản phẩm (kg)</strong></td>
              <td class="fw-bold text-dark">{{flower?.stockQuantity}}</td>
            </tr>
          </table>

          <!-- Danh mục sản phẩm -->
          <h6 class="text-secondary mt-3">Danh mục sản phẩm</h6>
          <ul class="text-dark" style="list-style-type: disc; padding-left: 20px;">
            <li *ngFor="let category of flower?.categories">{{category?.name}}</li>
          </ul>

          <!-- Mô tả sản phẩm -->
          <h6 class="text-secondary mt-3">Mô tả sản phẩm</h6>
          <p class="text-dark">{{flower?.description}}</p>

          <!-- Nút hành động -->
          @if (flower?.status === 'PENDING') {
            <div class="d-flex justify-content-end mt-5">
              <button mat-raised-button class="fs-20 px-4 mx-2" color="primary" style="flex: 1;"
                (click)="btnApproveFlower(flower?.id)">
                Đồng ý
                <mat-icon>task_alt</mat-icon>
              </button>
              <button mat-raised-button class="fs-20 px-4 mx-2" color="warn" style="flex: 1;"
                (click)="toggleRejectForm()">
                Từ chối
                <mat-icon>cancel</mat-icon>
              </button>
            </div>
          }
        </div>
      </div>
    </div>

    <!-- Thông tin người đăng -->
    <div class="col-md-6">
      <div class="card shadow-sm">
        <div class="card-body">
          <h3 class="primary-color mb-4">Thông tin người đăng</h3>
          <div class="d-flex flex-column align-items-center">
            <!-- Avatar của người dùng -->
            <img [src]="flower?.user?.avatar || 'https://via.placeholder.com/170'" alt="User Avatar"
              class="rounded-circle mb-3" style="width: 170px; height: 170px; object-fit: cover; border: 1px solid;" />
            <!-- Tên người dùng -->
            <h4 class="font-weight-bold text-dark">{{flower?.user?.name}}</h4>
            <p class="text-muted mb-2 fw-bold">Vai trò: <span class="blue-text">{{flower?.user?.role}}</span></p>
          </div>

          <!-- Thông tin chi tiết người dùng -->
          <ul class="list-group mt-4">
            <li class="list-group-item">
              <strong>Email: </strong>
              <span class="text-dark fw-bold">{{flower?.user?.email}}</span>
            </li>
            @if(flower?.user?.phone !== null){
              <li class="list-group-item">
                <strong>Số điện thoại: </strong>
                <span class="text-dark fw-bold">{{flower?.user?.phone}}</span>
              </li>
            } @else{
              <li class="list-group-item">
                <strong>Số điện thoại: </strong>
                <span class="text-dark fw-bold">Chưa cập nhật</span>
              </li>
            }
            <li class="list-group-item">
              <strong>Giới tính: </strong>
              <span class="text-dark fw-bold">{{flower?.user?.gender}}</span>
            </li>
            <li class="list-group-item">
              <strong>Số dư ví: </strong>
              <span class="text-success fw-bold">{{flower?.user?.balance | number}} VNĐ</span>
            </li>
          </ul>
        </div>
      </div>
      <!-- Phần form từ chối -->
      @if (isRejectFormVisible) {
      <div class="card shadow-sm mt-4">
        <div class="card-body">
          <h4 class="primary-color mb-4">Từ Chối Đơn Hoa</h4>
          <form [formGroup]="rejectForm" (ngSubmit)="btnDeniedFlower(flower?.id, reason)">
            <mat-form-field class="w-100 fs-16" appearance="outline">
              <mat-label>Nhập lý do từ chối</mat-label>
              <input matInput type="text" required formControlName="reason" />
            </mat-form-field>
            <div class="d-flex justify-content-end">
              <button type="submit" class="btn btn-danger mr-2">Xác nhận từ chối</button>
              <button type="button" class="btn btn-secondary" (click)="toggleRejectForm()">Hủy</button>
            </div>
          </form>
        </div>
      </div>
      }
    </div>
  </div>
</div>

}
